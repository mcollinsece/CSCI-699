{
    "resultsPerPage": 1,
    "startIndex": 0,
    "totalResults": 1,
    "format": "NVD_CVE",
    "version": "2.0",
    "timestamp": "2024-04-07T20:06:57.287",
    "vulnerabilities": [
        {
            "cve": {
                "id": "CVE-2022-25922",
                "sourceIdentifier": "ics-cert@hq.dhs.gov",
                "published": "2022-03-10T17:47:27.927",
                "lastModified": "2022-03-19T01:03:44.787",
                "vulnStatus": "Analyzed",
                "descriptions": [
                    {
                        "lang": "en",
                        "value": "Power Line Communications PLC4TRUCKS J2497 trailer brake controllers implement diagnostic functions which can be invoked by replaying J2497 messages. There is no authentication or authorization for these functions."
                    },
                    {
                        "lang": "es",
                        "value": "Los controladores de freno de remolque PLC4TRUCKS J2497 de Power Line Communications implementan funciones de diagn贸stico que pueden ser invocadas mediante la reproducci贸n de mensajes J2497. No se presenta autenticaci贸n ni autorizaci贸n para estas funciones"
                    }
                ],
                "metrics": {
                    "cvssMetricV31": [
                        {
                            "source": "nvd@nist.gov",
                            "type": "Primary",
                            "cvssData": {
                                "version": "3.1",
                                "vectorString": "CVSS:3.1\/AV:N\/AC:L\/PR:N\/UI:N\/S:U\/C:N\/I:H\/A:H",
                                "attackVector": "NETWORK",
                                "attackComplexity": "LOW",
                                "privilegesRequired": "NONE",
                                "userInteraction": "NONE",
                                "scope": "UNCHANGED",
                                "confidentialityImpact": "NONE",
                                "integrityImpact": "HIGH",
                                "availabilityImpact": "HIGH",
                                "baseScore": 9.1,
                                "baseSeverity": "CRITICAL"
                            },
                            "exploitabilityScore": 3.9,
                            "impactScore": 5.2
                        },
                        {
                            "source": "ics-cert@hq.dhs.gov",
                            "type": "Secondary",
                            "cvssData": {
                                "version": "3.1",
                                "vectorString": "CVSS:3.1\/AV:P\/AC:L\/PR:N\/UI:N\/S:U\/C:N\/I:H\/A:H",
                                "attackVector": "PHYSICAL",
                                "attackComplexity": "LOW",
                                "privilegesRequired": "NONE",
                                "userInteraction": "NONE",
                                "scope": "UNCHANGED",
                                "confidentialityImpact": "NONE",
                                "integrityImpact": "HIGH",
                                "availabilityImpact": "HIGH",
                                "baseScore": 6.1,
                                "baseSeverity": "MEDIUM"
                            },
                            "exploitabilityScore": 0.9,
                            "impactScore": 5.2
                        }
                    ],
                    "cvssMetricV2": [
                        {
                            "source": "nvd@nist.gov",
                            "type": "Primary",
                            "cvssData": {
                                "version": "2.0",
                                "vectorString": "AV:N\/AC:L\/Au:N\/C:N\/I:P\/A:P",
                                "accessVector": "NETWORK",
                                "accessComplexity": "LOW",
                                "authentication": "NONE",
                                "confidentialityImpact": "NONE",
                                "integrityImpact": "PARTIAL",
                                "availabilityImpact": "PARTIAL",
                                "baseScore": 6.4
                            },
                            "baseSeverity": "MEDIUM",
                            "exploitabilityScore": 10.0,
                            "impactScore": 4.9,
                            "acInsufInfo": false,
                            "obtainAllPrivilege": false,
                            "obtainUserPrivilege": false,
                            "obtainOtherPrivilege": false,
                            "userInteractionRequired": false
                        }
                    ]
                },
                "weaknesses": [
                    {
                        "source": "nvd@nist.gov",
                        "type": "Primary",
                        "description": [
                            {
                                "lang": "en",
                                "value": "CWE-306"
                            }
                        ]
                    },
                    {
                        "source": "ics-cert@hq.dhs.gov",
                        "type": "Secondary",
                        "description": [
                            {
                                "lang": "en",
                                "value": "CWE-306"
                            }
                        ]
                    }
                ],
                "configurations": [
                    {
                        "operator": "AND",
                        "nodes": [
                            {
                                "operator": "OR",
                                "negate": false,
                                "cpeMatch": [
                                    {
                                        "vulnerable": true,
                                        "criteria": "cpe:2.3:o:hegemonelectronics:plc4trucks_firmware:j2497:*:*:*:*:*:*:*",
                                        "matchCriteriaId": "774D3BA3-3A55-4B22-AA73-1D00E77459C0"
                                    }
                                ]
                            },
                            {
                                "operator": "OR",
                                "negate": false,
                                "cpeMatch": [
                                    {
                                        "vulnerable": false,
                                        "criteria": "cpe:2.3:h:hegemonelectronics:plc4trucks:-:*:*:*:*:*:*:*",
                                        "matchCriteriaId": "E2D5DA42-3968-479B-821F-539E853F5178"
                                    }
                                ]
                            }
                        ]
                    }
                ],
                "references": [
                    {
                        "url": "https:\/\/www.cisa.gov\/uscert\/ics\/advisories\/icsa-22-063-01",
                        "source": "ics-cert@hq.dhs.gov",
                        "tags": [
                            "Third Party Advisory",
                            "US Government Resource"
                        ]
                    }
                ]
            }
        }
    ]
}






CREATE TABLE cve_list (
    cve_id VARCHAR PRIMARY KEY,
    results_per_page INTEGER,
    start_index INTEGER,
    total_results INTEGER,
    format VARCHAR,
    version VARCHAR,
    timestamp TIMESTAMP,
    source_identifier VARCHAR,
    published TIMESTAMP,
    last_modified TIMESTAMP,
    vuln_status VARCHAR,
    descriptions JSONB,
    metrics_v31 JSONB,
    metrics_v2 JSONB,
    weaknesses JSONB,
    configurations JSONB,
    "references" JSONB,
    FOREIGN KEY (icsa) REFERENCES advisory_list (advisory_id)
);



CREATE TABLE cve_icsa_join (
    cve_id VARCHAR,
    icsa VARCHAR,
    PRIMARY KEY (cve_id, icsa),
    FOREIGN KEY (cve_id) REFERENCES cve_list (cve_id) ON DELETE CASCADE,
    FOREIGN KEY (icsa) REFERENCES advisory_list (icsa) ON DELETE CASCADE
);
